<html><head><link rel="import" href="./bower_components/polymer/polymer-element.html"><link rel="import" href="./bower_components/iron-ajax/iron-ajax.html"><link rel="import" href="./bower_components/paper-spinner/paper-spinner-lite.html"><link rel="import" href="./bower_components/paper-button/paper-button.html"><link rel="import" href="./bower_components/paper-toolbar/paper-toolbar.html"><script src="bower_components/chart.js/dist/Chart.js"></script><script src="bower_components/moment/moment.js"></script></head><body><dom-module id="crypto-dash"><template><style is="custom-style">paper-button.custom:hover{background-color:var(--paper-indigo-200);}paper-button.indigo{background-color:var(--paper-indigo-500);color:white;margin:5px;}paper-toolbar.red{--paper-toolbar-background:#F28500;--paper-toolbar-title:{font-family:Tahoma, Verdana, Segoe, sans-serif;margin-left:40%;font-weight:bold;};}</style><paper-toolbar class="red"><span slot="bottom" class="title">Crypto Currency Dashboard</span></paper-toolbar><iron-ajax id="coinbase" handle-as="json" on-response="_handleCryptoData" loading="{{loading}}"></iron-ajax><paper-spinner-lite active="{{loading}}"></paper-spinner-lite><div hidden="[[loading]]"></div><div><paper-button on-click="_getHistoricData" class="custom indigo">BTC :-$ {{currencies.btc.amount}}</paper-button><paper-button on-click="_getHistoricData" class="custom indigo">ETH :-$ {{currencies.eth.amount}}</paper-button><paper-button on-click="_getHistoricData" class="custom indigo">LTC :-$ {{currencies.ltc.amount}}</paper-button></div><hr><h2 id="titleContent" style="width: 100%; margin-left: 45%; font-family: Tahoma, Verdana, Segoe, sans-serif;"></h2><hr><div id="idcontent" class="chart-container" hidden$="[[loading]]" style="position: relative; width: 100%; max-width: 700px; margin: 0 auto;"><canvas height="2" width="4" id="id-canvas"></canvas></div></template><script>class CryptoDash extends Polymer.Element{static get is(){return"crypto-dash"}static get properties(){return{currencies:{type:Object,notify:!0,reflectToAttribute:!0,value:{name:"currencies",btc:{code:"BTC"},eth:{code:"ETH"},eth:{code:"LTC"}}},btc:String,ltc:String,eth:String,loading:{type:Boolean,value:!1,notify:!0},lineChart:{}}}ready(){super.ready(),Polymer.RenderStatus.afterNextRender(this,()=>{this._getCurrencyData()})}_getCurrencyData(){var a=this.$.coinbase;a.url="https://api.coinbase.com/v2/prices/USD/spot";let b=a.generateRequest();b.completes.then(()=>{this._getHistoricData(this.currencies.btc.base)},(a)=>{console.log("Polymer Promise is rejected",a.error)})}_getHistoricData(a){this.$.titleContent.innerHTML="BITCOIN","PAPER-BUTTON"==event.target.nodeName&&(a=event.target.innerHTML.substring(0,3).toLowerCase(),"ltc"==a&&(this.$.titleContent.innerHTML="LITECOIN"),"eth"==a&&(this.$.titleContent.innerHTML="ETHEREUM"));var b=this.$.coinbase;b.url="https://api.coinbase.com/v2/prices/"+a+"-USD/historic?period=week",b.generateRequest()}_handleCryptoData(a){if(a.detail.__data.response.data[0]!==void 0){console.log("This is spot");var b=a.detail.__data.response.data;this.set("currencies.btc",b[0]),this.set("currencies.eth",b[2]),this.set("currencies.ltc",b[3])}else console.log("This is history"),this._computeGraph(a.detail)}_computeDateTime(a){return a?moment(a,"YYYY-MM-DDThh:mm:aaZ").format("M/DD/YYYY hh:mm a"):a}_computeGraph(a){let b=a.url.substring(35,38),c=[],d=[];a.__data.response.data.prices.forEach((a)=>{c.push(a.price),d.push(this._computeDateTime(a.time))}),this._generateLineChart(d,c,b)}_generateLineChart(a,b,c){this.myLineChart!=void 0&&this.myLineChart.destroy();var d=this.$["id-canvas"].getContext("2d");this.myLineChart=new Chart(d,{type:"line",data:{labels:a,datasets:[{pointRadius:0,label:c,backgroundColor:"rgba(97, 153, 244, 0.8)",borderColor:"#000",borderWidth:3,data:b}]},options:{animation:{duration:1},hover:{animationDuration:1},responsiveAnimationDuration:1,tooltips:{mode:"index",intersect:!1},scales:{xAxes:[{gridLines:{display:!0}}],yAxes:[{gridLines:{display:!0}}]}}})}}window.customElements.define(CryptoDash.is,CryptoDash);</script></dom-module></body></html>